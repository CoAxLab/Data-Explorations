
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data as objects and architectures &#8212; Data explorations</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Discussion questions:" href="../discussions/data-as-objects-and-architectures.html" />
    <link rel="prev" title="Data as objects and architectures" href="../lectures/data-as-objects-and-architectures.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/brain.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data explorations</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Data explorations
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Phase 1 - Assessing the scene
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/art-of-data-investigations.html">
   Art of data investigations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="art-of-data-investigations.html">
     Tutorial: Getting started
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/the-value-of-openness.html">
   The value of openness
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="the-value-of-openness.html">
     The value of openness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/the-value-of-openness.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/what-is-a-theory.html">
   What is a theory?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/what-is-a-theory.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/constructing-a-testable-hypothesis.html">
   Constructing a testable hypothesis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/constructing-a-testable-hypothesis.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Phase 2 - Evaluating the evidence
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../lectures/data-as-objects-and-architectures.html">
   Data as objects and architectures
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Data as objects and architectures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/data-as-objects-and-architectures.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/techniques-for-data-cleansing.html">
   Techniques for data cleansing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="techniques-for-data-cleansing.html">
     Techniques for data cleansing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/techniques-for-data-cleansing.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/visualization-as-analysis.html">
   Visualization as analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="visualization-as-analysis.html">
     Visualization as analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/visualization-as-analysis.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/a-visualization-vocabulary.html">
   A visualization vocabulary
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/a-visualization-vocabulary.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/what-is-learnable.html">
   What is learnable?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/the-bias-variance-tradeoff.html">
   The bias-variance tradeoff
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/the-bias-variance-tradeoff.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/linear-models.html">
   Linear models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-models.html">
     Linear models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/linear-models.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/the-ordinary-least-squares-solution.html">
   The ordinary least squares solution
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="the-ordinary-least-squares-solution.html">
     The ordinary least squares solution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/the-ordinary-least-squares-solution.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/limits-of-linear-regression.html">
   Limits of linear regression
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="limits-of-linear-regression.html">
     Limits of linear regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/limits-of-linear-regression.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/mixed-effects-models.html">
   Mixed effects models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="mixed-effects-models.html">
     Mixed-effects models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/mixed-effects-models.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/classifiers.html">
   Classifiers
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="classifiers.html">
     Classifiers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/classifiers.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/the-beauty-of-knn.html">
   The beauty of kNN
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="the-beauty-of-knn.html">
     The beauty of kNN
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/cross-validation.html">
   Cross validation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="cross-validation.html">
     Cross-validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/cross-validation.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/resampling-methods.html">
   Resampling methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="resampling-methods.html">
     Resampling methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/resampling-methods.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/power-analysis-via-simulations.html">
   Power analysis via simulations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="power-analysis-via-simulations.html">
     Power analysis via simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/power-analysis-via-simulations.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/mediation-and-moderation.html">
   Mediation and moderation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="mediation-and-moderation.html">
     Mediation and moderation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/mediation-and-moderation.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/selecting-the-best-model.html">
   Selecting the best model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
  <label for="toctree-checkbox-21">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="selecting-the-best-model.html">
     Selecting the best model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/selecting-the-best-model.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/regularized-regression.html">
   Regularized regression
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
  <label for="toctree-checkbox-22">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="regularized-regression.html">
     Regularized regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/regularized-regression.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/principal-component-methods.html">
   The value of openness
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
  <label for="toctree-checkbox-23">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="principal-component-methods.html">
     Principal component methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/principal-component-methods.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Phase 3 - Solving the mystery
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/reconsidering-the-p-value.html">
   Reconsidering the p-value
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
  <label for="toctree-checkbox-24">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/reconsidering-the-p-value.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/bayes-factor-accepting-the-null.html">
   Bayes factor: accepting the null
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
  <label for="toctree-checkbox-25">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="bayes-factor-accepting-the-null.html">
     Bayes factor: accepting the null
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/bayes-factor-accepting-the-null.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/telling-your-data-story.html">
   Telling your data story
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
  <label for="toctree-checkbox-26">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../discussions/telling-your-data-story.html">
     Discussion questions:
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/data-as-objects-and-architectures.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/CoAxLab/Data-Explorations/main?urlpath=tree/book/notebooks/data-as-objects-and-architectures.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/CoAxLab/Data-Explorations/blob/main/book/notebooks/data-as-objects-and-architectures.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Data as objects and architectures
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#goals">
     Goals:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-started">
   Getting started
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-r-commands">
   Basic R Commands
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#arithmetic">
     Arithmetic
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-structures">
     Data structures
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indexing">
     Indexing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tidy-data">
   Tidy data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pipes-the-operator">
   Pipes - the %&gt;% operator
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transforming-data">
   Transforming data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transforming-existing-variables-and-creating-new-variables-mutate">
     Transforming existing variables and creating new variables -  mutate()
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summarizing-variables-summarise">
     Summarizing variables - summarise()
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering-a-data-frame-by-removing-rows-based-on-a-condition-filter">
     Filtering a data.frame by removing rows based on a condition - filter()
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#removing-selecting-columns-to-keep-select">
     Removing/selecting columns to keep - select()
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sorting-the-data-frame-by-columns-arrange">
     Sorting the data.frame by columns - arrange()
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#combine-concatenate-values-from-two-columns-into-one-unite">
     Combine/concatenate values from two columns into one - unite()
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#split-variable-into-multiple-variables-separate">
     Split variable into multiple variables - separate()
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#performing-the-same-operation-for-multiple-groups-and-combining-the-results">
   Performing the same operation for multiple groups and combining the results
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#restructuring-data-frames-long-to-wide-wide-to-long-and-merging-data-frames">
   Restructuring data.frames - long to wide, wide to long, and merging data.frames
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="data-as-objects-and-architectures">
<h1>Data as objects and architectures<a class="headerlink" href="#data-as-objects-and-architectures" title="Permalink to this headline">¶</a></h1>
<p>This lab serves as an introduction to data processing in R and the concept of tidy data.</p>
<div class="section" id="goals">
<h2>Goals:<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Learn basic R commands</p></li>
<li><p>Learn how to use <code class="docutils literal notranslate"><span class="pre">tidyverse</span></code></p></li>
<li><p>Learn about the pipe operator</p></li>
<li><p>Learn various data transformations in R</p></li>
</ul>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>For many people, their first instinct is to open the data with Excel and just manually clean-up the data, by replacing values, creating new columns, etc., entirely by hand. The problem with that approach is that you cannot easily replicate the steps you have taken to transform the raw data into the final format you use for your analyses. This issue has many consequences, but among the two most common are, first, that if you get new or additional data from the same source, you would have to manually perform the same operations again, and second, if you make a mistake it would be difficult to identify where exactly that happened. The best approach is to preprocess your data with a script in the same way you do your analyses. However, doing so in base R can be quite cumbersome. In this tutorial, you will learn how to use tools for the <strong><code class="docutils literal notranslate"><span class="pre">tidyverse</span></code></strong> packages. Tidyverse is a collection of useful packages, which include <strong><code class="docutils literal notranslate"><span class="pre">ggplot2</span></code></strong>, <strong><code class="docutils literal notranslate"><span class="pre">tidyr</span></code></strong>, <strong><code class="docutils literal notranslate"><span class="pre">dplyr</span></code></strong>, etc, combined in a single package.</p>
<p>Before we begin, you’ll need to install and load the <code class="docutils literal notranslate"><span class="pre">tidyverse</span></code> package:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># function to install the packages if missing, otherwise, just load them</span>
<span class="n">import_packages</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">packages</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">package</span> <span class="n">in</span> <span class="n">packages</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">package</span> <span class="o">%in%</span> <span class="nf">row.names</span><span class="p">(</span><span class="nf">installed.packages</span><span class="p">())))</span> <span class="p">{</span> <span class="c1">#if the package is not installed</span>
            <span class="nf">install.packages</span><span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">repos</span> <span class="o">=</span> <span class="s">&quot;http://cran.us.r-project.org&quot;</span><span class="p">)</span> <span class="c1">#install from archive</span>
        <span class="p">}</span> 
        <span class="nf">library</span><span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">character.only</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="c1">#load the set of packages that you gave to the function</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nf">import_packages</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;tidyverse&#39;</span><span class="p">))</span> <span class="c1">#call the function with tidyverse as the input</span>
</pre></div>
</div>
</div>
</div>
<p>Or you can do this:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;tidyverse&#39;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</pre></div>
</div>
<p>Below is a summary of the functions we will review and their general description:</p>
<ul class="simple">
<li><p><strong>mutate()</strong> - transforming existing variables and creating new variables</p></li>
<li><p><strong>summarise()</strong> - summarizing variables</p></li>
<li><p><strong>filter()</strong> - filtering dataframes</p></li>
<li><p><strong>select()</strong> - selecting columns to keep/remove</p></li>
<li><p><strong>arrange()</strong> - sorting by column/columns</p></li>
<li><p><strong>join()</strong> - merging multiple dataframes</p></li>
<li><p><strong>group_by()</strong> - performing the same operation to different subgroups of data and combining the results</p></li>
<li><p><strong>spread()</strong> - transforming data to wide format</p></li>
<li><p><strong>gather()</strong> - transforming data to long format</p></li>
<li><p><strong>separate()</strong> - split one column into multiple columns</p></li>
<li><p><strong>unite()</strong> - combine two columns into one</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="basic-r-commands">
<h1>Basic R Commands<a class="headerlink" href="#basic-r-commands" title="Permalink to this headline">¶</a></h1>
<div class="section" id="arithmetic">
<h2>Arithmetic<a class="headerlink" href="#arithmetic" title="Permalink to this headline">¶</a></h2>
<p>In R, you can do basic arithmetic just like any other programming language e.g.,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="m">6+2</span>
<span class="m">10-3</span><span class="o">*</span><span class="m">4</span>
<span class="m">5</span><span class="o">^</span><span class="m">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">8</div><div class="output text_html">-2</div><div class="output text_html">125</div></div>
</div>
</div>
<div class="section" id="data-structures">
<h2>Data structures<a class="headerlink" href="#data-structures" title="Permalink to this headline">¶</a></h2>
<p>Vectors: vectors are lists of numbers or strings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">b</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">6</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;mean of vector a:&quot;</span><span class="p">,</span><span class="nf">mean</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;sum of vector b:&quot;</span><span class="p">,</span><span class="nf">sum</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;mean of vector a: 2&quot;
[1] &quot;sum of vector b: 15&quot;
</pre></div>
</div>
</div>
</div>
<p>You can do element-wise operations on two vectors easily:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">*</span><span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>4</li><li>10</li><li>18</li></ol>
</div></div>
</div>
<p>Data frames: data frames can contain data of mixed types such as numbers and strings. Usually, each column is a different variable (e.g., Age, Test Score), and items within each column are of the same type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;one&quot;</span><span class="p">,</span><span class="s">&quot;two&quot;</span><span class="p">,</span><span class="s">&quot;three&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">avar</span><span class="o">=</span><span class="n">a</span><span class="p">,</span><span class="n">bvar</span><span class="o">=</span><span class="n">b</span><span class="p">,</span><span class="n">cvar</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 3 × 3</caption>
<thead>
	<tr><th scope=col>avar</th><th scope=col>bvar</th><th scope=col>cvar</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1</td><td>4</td><td>one  </td></tr>
	<tr><td>2</td><td>5</td><td>two  </td></tr>
	<tr><td>3</td><td>6</td><td>three</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>In the data frame printed above, you can see that both variables <strong>avar</strong> and <strong>bvar</strong> are type <strong>&lt;dbl&gt;</strong> (short for “double”, another term for numeric) while variable <strong>cvar</strong> is type <strong>&lt;chr&gt;</strong>, or “character”.</p>
</div>
<div class="section" id="indexing">
<h2>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline">¶</a></h2>
<p>In a vector, you can index data by its position (starting at index 1):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">2</div></div>
</div>
<p>You can index data by its column and row number in a data frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">2</div></div>
</div>
<p>You can also index a particular column in a data frame by its variable name:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">$</span><span class="n">bvar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>4</li><li>5</li><li>6</li></ol>
</div></div>
</div>
<p>Or, you can access a particular column or row by its position in the data frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Column 3&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[,</span><span class="m">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Column 3&quot;
</pre></div>
</div>
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'one'</li><li>'two'</li><li>'three'</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;Row 1&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="m">1</span><span class="p">,]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Row 1&quot;
</pre></div>
</div>
<div class="output text_html"><table>
<caption>A data.frame: 1 × 3</caption>
<thead>
	<tr><th></th><th scope=col>avar</th><th scope=col>bvar</th><th scope=col>cvar</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>1</td><td>4</td><td>one</td></tr>
</tbody>
</table>
</div></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="tidy-data">
<h1>Tidy data<a class="headerlink" href="#tidy-data" title="Permalink to this headline">¶</a></h1>
<p>The key concept here is called <strong>tidy data</strong>. Tidy data assumes that your data is organized as follows:</p>
<ul class="simple">
<li><p>Columns are variables</p></li>
<li><p>Rows are individual observations</p></li>
<li><p>Observation for each variable is stored in the corresponding cell</p></li>
</ul>
<p>There are two versions of the tidy data format - long and wide. To illustrate the difference, imagine a repeated measures dataset, where you gather four observations for each subject at four different time points. In the <strong>long data</strong> format, the columns will be <em>subject</em>, <em>timepoint</em>, and <em>observation</em>, where each row will be one observation at a specific timepoint for a specific subject. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">long_data</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">subject</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="n">each</span><span class="o">=</span><span class="m">4</span><span class="p">),</span>
                        <span class="n">timepoint</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="m">3</span><span class="p">),</span>
                        <span class="n">observation</span> <span class="o">=</span> <span class="nf">round</span><span class="p">(</span><span class="nf">rnorm</span><span class="p">(</span><span class="m">12</span><span class="p">),</span> <span class="m">2</span><span class="p">))</span>
<span class="n">long_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 12 × 3</caption>
<thead>
	<tr><th scope=col>subject</th><th scope=col>timepoint</th><th scope=col>observation</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1</td><td>1</td><td> 0.56</td></tr>
	<tr><td>1</td><td>2</td><td>-0.48</td></tr>
	<tr><td>1</td><td>3</td><td> 0.64</td></tr>
	<tr><td>1</td><td>4</td><td>-0.18</td></tr>
	<tr><td>2</td><td>1</td><td> 0.38</td></tr>
	<tr><td>2</td><td>2</td><td> 0.56</td></tr>
	<tr><td>2</td><td>3</td><td>-1.83</td></tr>
	<tr><td>2</td><td>4</td><td>-0.43</td></tr>
	<tr><td>3</td><td>1</td><td>-0.94</td></tr>
	<tr><td>3</td><td>2</td><td>-1.57</td></tr>
	<tr><td>3</td><td>3</td><td> 1.32</td></tr>
	<tr><td>3</td><td>4</td><td>-0.31</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Alternatively, the data can be organized in a <strong>wide format</strong>, in which the four different timepoints are represented as different columns, each row is a single subject, and the observation for each timepoint is stored at a cell within that column. Like this (don’t worry about the code for now, it is explained in the subsequent section):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">long_data</span>  <span class="o">%&gt;%</span> 
    <span class="nf">mutate</span><span class="p">(</span><span class="n">timepoint</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">,</span><span class="n">timepoint</span><span class="p">))</span>  <span class="o">%&gt;%</span> 
    <span class="nf">spread</span><span class="p">(</span><span class="n">timepoint</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 3 × 5</caption>
<thead>
	<tr><th scope=col>subject</th><th scope=col>time1</th><th scope=col>time2</th><th scope=col>time3</th><th scope=col>time4</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1</td><td> 0.56</td><td>-0.48</td><td> 0.64</td><td>-0.18</td></tr>
	<tr><td>2</td><td> 0.38</td><td> 0.56</td><td>-1.83</td><td>-0.43</td></tr>
	<tr><td>3</td><td>-0.94</td><td>-1.57</td><td> 1.32</td><td>-0.31</td></tr>
</tbody>
</table>
</div></div>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="pipes-the-operator">
<h1>Pipes - the %&gt;% operator<a class="headerlink" href="#pipes-the-operator" title="Permalink to this headline">¶</a></h1>
<p>You might have noticed the weird <strong>%&gt;%</strong> operator in the code in the previous section. This operator is called a <strong>‘pipe’</strong>. Pipes are present in many programming languages, but not in the base R, so you might not be familiar with them. Pipes are an added feature from the Tidyverse package.</p>
<p>A pipe serves as a link between two objects, whether they be variables or functions. The pipe tells R to take the object on its left side and pass it as the first argument to the object on the right.</p>
<p>Typically in R, if you want to pass an argument to a function, you specify it as <code class="docutils literal notranslate"><span class="pre">function(argument)</span></code>. For example, if you want to find the mean of the observations in the example shown above, in base R you would do this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">mean</span><span class="p">(</span><span class="n">long_data</span><span class="o">$</span><span class="n">observation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">-0.19</div></div>
</div>
<p>If you use a pipe, you just put the argument on its left side, and the function on the right, i.e., <code class="docutils literal notranslate"><span class="pre">variable</span>&#160; <span class="pre">%&gt;%</span> <span class="pre">function()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">long_data</span><span class="o">$</span><span class="n">observation</span>  <span class="o">%&gt;%</span> <span class="nf">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">-0.19</div></div>
</div>
<p>Now, you might be asking, why would you want to use <strong>x %&gt;% mean()</strong> instead of <strong>mean(x)</strong>? Pipes come in handy, particularly when you have to run a series of functions on the same input. For example, let’s say you want to find the mean of the observations, and then round the value to 2 significant digits. In base R, you can do this in two ways:</p>
<ol class="simple">
<li><p>nest the functions within one another</p></li>
<li><p>assign a temporary variable for the mean, and then round that value</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># nested</span>
<span class="nf">round</span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">long_data</span><span class="o">$</span><span class="n">observation</span><span class="p">),</span> <span class="m">2</span><span class="p">)</span>

<span class="c1"># tmp variable</span>
<span class="n">obs_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">long_data</span><span class="o">$</span><span class="n">observation</span><span class="p">)</span>
<span class="nf">round</span><span class="p">(</span><span class="n">obs_mean</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">-0.19</div><div class="output text_html">-0.19</div></div>
</div>
<p>Since pipes take the output of the expression on the left and send it as the first input to the expression on the right, you can do the following with pipes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># with pipes</span>
<span class="n">long_data</span><span class="o">$</span><span class="n">observation</span>  <span class="o">%&gt;%</span> <span class="nf">mean</span><span class="p">()</span>  <span class="o">%&gt;%</span> <span class="nf">round</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">-0.19</div></div>
</div>
<p>This reads smoothly from left to right as, “Take the observations, find the mean and then round it to two decimals.” To increase readability even further, you can put a new row after each pipe operator - R automatically assumes that if there is nothing after the %&gt;% on the same row, it should pass the result to whatever comes on the next row. Thus, we can rewrite the above example as:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># pipes on separate rows:</span>
<span class="n">long_data</span><span class="o">$</span><span class="n">observation</span>  <span class="o">%&gt;%</span> 
  <span class="nf">mean</span><span class="p">()</span> <span class="o">%&gt;%</span> 
  <span class="nf">round</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">-0.19</div></div>
</div>
<p>Notice that typically the <code class="docutils literal notranslate"><span class="pre">round()</span></code> function takes as first argument the value to be rounded, and as a second argument the number of digits to which to round. When you use a pipe, the first argument is implicitely filled in with the value on the left, so the first argument you actually type corresponds to the number of significant digits to which to round.</p>
<p>Pipes become very useful when using the functions we’ll discuss below, because you would usually use many of them on the same data, and while the above example might be easy to read in all three cases, it becomes very difficult to track what is going on with the base R approach. <strong>Thus pipes have two advantages:</strong></p>
<ol class="simple">
<li><p><strong>Readability</strong> - it is easier to see what goes on, because you can track the sequence naturally left to right. In contrast, with nested functions, you have to identify the inner-most function and then work your way outwards.</p></li>
<li><p><strong>Efficiency</strong> - do not clutter your environment with temporary variables that you needed for only one intermediary observation.</p></li>
</ol>
<p>To show the difference in readability, here is how the code for the long to wide functions would look if we wrote it with nested functions, rather than with pipes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># with pipes</span>
<span class="n">long_data</span>  <span class="o">%&gt;%</span> 
    <span class="nf">mutate</span><span class="p">(</span><span class="n">timepoint</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">,</span><span class="n">timepoint</span><span class="p">))</span>  <span class="o">%&gt;%</span> 
    <span class="nf">spread</span><span class="p">(</span><span class="n">timepoint</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span>

<span class="c1"># nested functions</span>
<span class="nf">spread</span><span class="p">(</span><span class="nf">mutate</span><span class="p">(</span><span class="n">long_data</span><span class="p">,</span> <span class="n">timepoint</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">,</span><span class="n">timepoint</span><span class="p">)),</span> <span class="n">timepoint</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span>

<span class="c1"># temporary variables</span>
<span class="n">mutated_data</span> <span class="o">&lt;-</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">long_data</span><span class="p">,</span> <span class="n">timepoint</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">,</span><span class="n">timepoint</span><span class="p">))</span>
<span class="nf">spread</span><span class="p">(</span><span class="n">mutated_data</span><span class="p">,</span> <span class="n">timepoint</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 3 × 5</caption>
<thead>
	<tr><th scope=col>subject</th><th scope=col>time1</th><th scope=col>time2</th><th scope=col>time3</th><th scope=col>time4</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1</td><td> 0.56</td><td>-0.48</td><td> 0.64</td><td>-0.18</td></tr>
	<tr><td>2</td><td> 0.38</td><td> 0.56</td><td>-1.83</td><td>-0.43</td></tr>
	<tr><td>3</td><td>-0.94</td><td>-1.57</td><td> 1.32</td><td>-0.31</td></tr>
</tbody>
</table>
</div><div class="output text_html"><table>
<caption>A data.frame: 3 × 5</caption>
<thead>
	<tr><th scope=col>subject</th><th scope=col>time1</th><th scope=col>time2</th><th scope=col>time3</th><th scope=col>time4</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1</td><td> 0.56</td><td>-0.48</td><td> 0.64</td><td>-0.18</td></tr>
	<tr><td>2</td><td> 0.38</td><td> 0.56</td><td>-1.83</td><td>-0.43</td></tr>
	<tr><td>3</td><td>-0.94</td><td>-1.57</td><td> 1.32</td><td>-0.31</td></tr>
</tbody>
</table>
</div><div class="output text_html"><table>
<caption>A data.frame: 3 × 5</caption>
<thead>
	<tr><th scope=col>subject</th><th scope=col>time1</th><th scope=col>time2</th><th scope=col>time3</th><th scope=col>time4</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1</td><td> 0.56</td><td>-0.48</td><td> 0.64</td><td>-0.18</td></tr>
	<tr><td>2</td><td> 0.38</td><td> 0.56</td><td>-1.83</td><td>-0.43</td></tr>
	<tr><td>3</td><td>-0.94</td><td>-1.57</td><td> 1.32</td><td>-0.31</td></tr>
</tbody>
</table>
</div></div>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="transforming-data">
<h1>Transforming data<a class="headerlink" href="#transforming-data" title="Permalink to this headline">¶</a></h1>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">iris</span></code> dataset for illustrating the tidyverse functions. You can save it to a <code class="docutils literal notranslate"><span class="pre">dat</span></code> variable like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span> <span class="o">&lt;-</span> <span class="n">iris</span>
<span class="nf">head</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 5</caption>
<thead>
	<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>2</th><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>3</th><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>4</th><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>5</th><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>6</th><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">iris</span></code> dataset contains <a class="reference external" href="https://eloquentarduino.github.io/2019/12/iris-classification-on-arduino/">measurement data</a> for different species of iris flowers. You can view a detailed description of the dataset by typing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">?</span><span class="n">iris</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s a peak at the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">head</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 5</caption>
<thead>
	<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>2</th><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>3</th><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>4</th><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>5</th><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>6</th><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="section" id="transforming-existing-variables-and-creating-new-variables-mutate">
<h2>Transforming existing variables and creating new variables -  mutate()<a class="headerlink" href="#transforming-existing-variables-and-creating-new-variables-mutate" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">mutate()</span></code> is part of <code class="docutils literal notranslate"><span class="pre">dplyr</span></code>, one of the packages included in <code class="docutils literal notranslate"><span class="pre">tidyverse</span></code> that is handy for data manipulation. The <code class="docutils literal notranslate"><span class="pre">mutate()</span></code> command allows you to create new columns, i.e. new variables.  Let’s say you want to center the sepal lengths in the <code class="docutils literal notranslate"><span class="pre">iris</span></code> dataset by removing the mean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span> <span class="o">&lt;-</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">centered_SepLen</span> <span class="o">=</span> <span class="n">Sepal.Length</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">))</span>
<span class="nf">head</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 6</caption>
<thead>
	<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th><th scope=col>centered_SepLen</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.7433333</td></tr>
	<tr><th scope=row>2</th><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.9433333</td></tr>
	<tr><th scope=row>3</th><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa</td><td>-1.1433333</td></tr>
	<tr><th scope=row>4</th><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>setosa</td><td>-1.2433333</td></tr>
	<tr><th scope=row>5</th><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.8433333</td></tr>
	<tr><th scope=row>6</th><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa</td><td>-0.4433333</td></tr>
</tbody>
</table>
</div></div>
</div>
<p><strong>In all <code class="docutils literal notranslate"><span class="pre">dplyr</span></code> commands, including <code class="docutils literal notranslate"><span class="pre">mutate</span></code>, the first argument is always the dataset</strong>, and after that you can specify what new variables you want to create using <code class="docutils literal notranslate"><span class="pre">variable_name</span> <span class="pre">=</span> <span class="pre">value</span></code>. All commands in the <code class="docutils literal notranslate"><span class="pre">dplyr</span></code> package allow you to create and reference variables within a data.frame object, without needing to type in the name of the data.frame each time. For example, if you want to create several variables in base R (that is, without using <code class="docutils literal notranslate"><span class="pre">dplyr</span></code> functions), you would have to do this everytime:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># center sepal length</span>
<span class="n">dat</span><span class="o">$</span><span class="n">centered_SepLen</span> <span class="o">=</span> <span class="n">dat</span><span class="o">$</span><span class="n">Sepal.Length</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">)</span> 
<span class="c1"># transforms petal length into zscores</span>
<span class="n">dat</span><span class="o">$</span><span class="n">PetLen_zscores</span> <span class="o">=</span> <span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Petal.Length</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">))</span><span class="o">/</span><span class="nf">sd</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">dplyr</span></code>, you don’t have to write <code class="docutils literal notranslate"><span class="pre">dat$</span></code> every time you refer to a variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span> <span class="o">&lt;-</span> <span class="n">dat</span>  <span class="o">%&gt;%</span>  
    <span class="nf">mutate</span><span class="p">(</span><span class="n">centered_SepLen</span> <span class="o">=</span> <span class="n">Sepal.Length</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">),</span>  <span class="c1"># center Sepal Lengths</span>
           <span class="n">PetLen_zscores</span> <span class="o">=</span> <span class="p">(</span><span class="n">Petal.Length</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Petal.Length</span><span class="p">))</span><span class="o">/</span><span class="nf">sd</span><span class="p">(</span><span class="n">Petal.Length</span><span class="p">),</span>  <span class="c1"># zscore the Petal Lengths</span>
           <span class="n">n_flowers</span> <span class="o">=</span> <span class="nf">length</span><span class="p">(</span><span class="n">Species</span><span class="p">))</span>              <span class="c1"># calculate the total number of flowers</span>
<span class="nf">head</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 8</caption>
<thead>
	<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th><th scope=col>centered_SepLen</th><th scope=col>PetLen_zscores</th><th scope=col>n_flowers</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.7433333</td><td>-1.335752</td><td>150</td></tr>
	<tr><th scope=row>2</th><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.9433333</td><td>-1.335752</td><td>150</td></tr>
	<tr><th scope=row>3</th><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa</td><td>-1.1433333</td><td>-1.392399</td><td>150</td></tr>
	<tr><th scope=row>4</th><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>setosa</td><td>-1.2433333</td><td>-1.279104</td><td>150</td></tr>
	<tr><th scope=row>5</th><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.8433333</td><td>-1.335752</td><td>150</td></tr>
	<tr><th scope=row>6</th><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa</td><td>-0.4433333</td><td>-1.165809</td><td>150</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>As you see, you can create multiple variables at the same time within a single mutate command, by separating them with commas. This time, rather than specifying <em>dat</em> as the first argument of mutate explicitely, we directed it with a pipe, as explained before. The first line should be read as <em>‘Pass the dat variable to whatever follows, then save the results in the dat variable.’</em></p>
</div>
<div class="section" id="summarizing-variables-summarise">
<h2>Summarizing variables - summarise()<a class="headerlink" href="#summarizing-variables-summarise" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Mutate()</span></code> creates new variables within the existing dataset and does not change the number of rows. You might also want to calculate statistics that summarize the whole data set. For example, in the example above I calculated how many flowers were measured total (<code class="docutils literal notranslate"><span class="pre">n_flowers</span></code>) - but it doesn’t really make sense to output this as a variable with entries for every observation. If you want to create a new data.frame in which you store the summary values for one or more variables, you can use the <code class="docutils literal notranslate"><span class="pre">summarise()</span></code> command. Let’s get summaries for a few of the existing variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">smry</span> <span class="o">&lt;-</span> <span class="n">dat</span>  <span class="o">%&gt;%</span> 
    <span class="nf">summarise</span><span class="p">(</span><span class="n">n_flowers</span> <span class="o">=</span> <span class="nf">length</span><span class="p">(</span><span class="n">Species</span><span class="p">),</span> <span class="c1"># how many observations (flowers) are there total? </span>
              <span class="n">shortSepal_prop</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">centered_SepLen</span> <span class="o">&lt;</span> <span class="m">0</span><span class="p">),</span> <span class="c1"># what proportion of these flowers have smaller-than-average sepal length?</span>
              <span class="n">setosa_prop</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Species</span> <span class="o">==</span> <span class="s">&#39;setosa&#39;</span><span class="p">),</span> <span class="c1"># what proportion of measured flowers are species Setosa?</span>
              <span class="n">SepLen_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">),</span> <span class="c1"># mean sepal length</span>
              <span class="n">SepLen_sd</span> <span class="o">=</span> <span class="nf">sd</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">),</span> <span class="c1"># standard deviation of sepal length</span>
              <span class="n">SepLen_se</span> <span class="o">=</span> <span class="n">SepLen_sd</span> <span class="o">/</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">n_flowers</span><span class="p">)</span>
              <span class="p">)</span>
<span class="n">smry</span>
              
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 1 × 6</caption>
<thead>
	<tr><th scope=col>n_flowers</th><th scope=col>shortSepal_prop</th><th scope=col>setosa_prop</th><th scope=col>SepLen_mean</th><th scope=col>SepLen_sd</th><th scope=col>SepLen_se</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>150</td><td>0.5333333</td><td>0.3333333</td><td>5.843333</td><td>0.8280661</td><td>0.06761132</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>You should note several things. When you get to a new row, you can refer to a variable you have already created on a previous row. For example, when we calculate the standard error for <code class="docutils literal notranslate"><span class="pre">Sepal.Length</span></code>, we have put <code class="docutils literal notranslate"><span class="pre">SepLen_se</span> <span class="pre">=</span> <span class="pre">SepLen_sd</span> <span class="pre">/</span> <span class="pre">sqrt(n_flowers)</span></code>, in which SepLen_sd and n_flowers do not exist in the original data.frame, but are variables that we created on previous rows. We could have written it directly as <code class="docutils literal notranslate"><span class="pre">SepLen_se</span> <span class="pre">=</span> <span class="pre">sd(Sepal.Length)</span> <span class="pre">/</span> <span class="pre">sqrt(length(Species))</span></code>, but doing it in the above way is more efficient and readable.</p>
</div>
<div class="section" id="filtering-a-data-frame-by-removing-rows-based-on-a-condition-filter">
<h2>Filtering a data.frame by removing rows based on a condition - filter()<a class="headerlink" href="#filtering-a-data-frame-by-removing-rows-based-on-a-condition-filter" title="Permalink to this headline">¶</a></h2>
<p>Here are three scenarios:</p>
<ul class="simple">
<li><p>you find that there was an error with data collection for one species of flower (e.g. setosa) and you want to remove it from the data.frame</p></li>
<li><p>you find out that some flowers have a negative <code class="docutils literal notranslate"><span class="pre">Sepal.Length</span></code> value, which is an error, and you want to remove them</p></li>
<li><p>you want to separate the data for the remaining two species into separate datasets</p></li>
</ul>
<p>You can do all of these things with the <strong><code class="docutils literal notranslate"><span class="pre">filter</span></code></strong> command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#39;species options:&#39;</span><span class="p">,</span><span class="nf">paste</span><span class="p">(</span><span class="nf">levels</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">Species</span><span class="p">),</span><span class="n">collapse</span><span class="o">=</span><span class="s">&quot;, &quot;</span><span class="p">)))</span>

<span class="c1"># get rid of all setosa flowers and any flowers with negative sepal lengths</span>
<span class="n">cleaned_dat</span> <span class="o">&lt;-</span> <span class="n">dat</span>  <span class="o">%&gt;%</span> 
    <span class="nf">filter</span><span class="p">(</span><span class="n">Species</span> <span class="o">!=</span> <span class="s">&#39;setosa&#39;</span><span class="p">,</span>
           <span class="n">Sepal.Length</span> <span class="o">&gt;=</span> <span class="m">0</span><span class="p">)</span>

<span class="c1"># make new data.frames for the remaining two species</span>
<span class="n">versi.dat</span> <span class="o">&lt;-</span> <span class="nf">filter</span><span class="p">(</span><span class="n">cleaned_dat</span><span class="p">,</span> <span class="n">Species</span> <span class="o">==</span> <span class="s">&#39;versicolor&#39;</span><span class="p">)</span>
<span class="n">virgi.dat</span> <span class="o">&lt;-</span> <span class="nf">filter</span><span class="p">(</span><span class="n">cleaned_dat</span><span class="p">,</span> <span class="n">Species</span> <span class="o">==</span> <span class="s">&#39;virginica&#39;</span><span class="p">)</span>

<span class="c1"># look at first six rows of all three data.frames</span>
<span class="nf">head</span><span class="p">(</span><span class="n">cleaned_dat</span><span class="p">);</span> <span class="nf">head</span><span class="p">(</span><span class="n">versi.dat</span><span class="p">);</span> <span class="nf">head</span><span class="p">(</span><span class="n">virgi.dat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;species options: setosa, versicolor, virginica&quot;
</pre></div>
</div>
<div class="output text_html"><table>
<caption>A data.frame: 6 × 8</caption>
<thead>
	<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th><th scope=col>centered_SepLen</th><th scope=col>PetLen_zscores</th><th scope=col>n_flowers</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>7.0</td><td>3.2</td><td>4.7</td><td>1.4</td><td>versicolor</td><td> 1.1566667</td><td>0.5336209</td><td>150</td></tr>
	<tr><th scope=row>2</th><td>6.4</td><td>3.2</td><td>4.5</td><td>1.5</td><td>versicolor</td><td> 0.5566667</td><td>0.4203256</td><td>150</td></tr>
	<tr><th scope=row>3</th><td>6.9</td><td>3.1</td><td>4.9</td><td>1.5</td><td>versicolor</td><td> 1.0566667</td><td>0.6469162</td><td>150</td></tr>
	<tr><th scope=row>4</th><td>5.5</td><td>2.3</td><td>4.0</td><td>1.3</td><td>versicolor</td><td>-0.3433333</td><td>0.1370873</td><td>150</td></tr>
	<tr><th scope=row>5</th><td>6.5</td><td>2.8</td><td>4.6</td><td>1.5</td><td>versicolor</td><td> 0.6566667</td><td>0.4769732</td><td>150</td></tr>
	<tr><th scope=row>6</th><td>5.7</td><td>2.8</td><td>4.5</td><td>1.3</td><td>versicolor</td><td>-0.1433333</td><td>0.4203256</td><td>150</td></tr>
</tbody>
</table>
</div><div class="output text_html"><table>
<caption>A data.frame: 6 × 8</caption>
<thead>
	<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th><th scope=col>centered_SepLen</th><th scope=col>PetLen_zscores</th><th scope=col>n_flowers</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>7.0</td><td>3.2</td><td>4.7</td><td>1.4</td><td>versicolor</td><td> 1.1566667</td><td>0.5336209</td><td>150</td></tr>
	<tr><th scope=row>2</th><td>6.4</td><td>3.2</td><td>4.5</td><td>1.5</td><td>versicolor</td><td> 0.5566667</td><td>0.4203256</td><td>150</td></tr>
	<tr><th scope=row>3</th><td>6.9</td><td>3.1</td><td>4.9</td><td>1.5</td><td>versicolor</td><td> 1.0566667</td><td>0.6469162</td><td>150</td></tr>
	<tr><th scope=row>4</th><td>5.5</td><td>2.3</td><td>4.0</td><td>1.3</td><td>versicolor</td><td>-0.3433333</td><td>0.1370873</td><td>150</td></tr>
	<tr><th scope=row>5</th><td>6.5</td><td>2.8</td><td>4.6</td><td>1.5</td><td>versicolor</td><td> 0.6566667</td><td>0.4769732</td><td>150</td></tr>
	<tr><th scope=row>6</th><td>5.7</td><td>2.8</td><td>4.5</td><td>1.3</td><td>versicolor</td><td>-0.1433333</td><td>0.4203256</td><td>150</td></tr>
</tbody>
</table>
</div><div class="output text_html"><table>
<caption>A data.frame: 6 × 8</caption>
<thead>
	<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th><th scope=col>centered_SepLen</th><th scope=col>PetLen_zscores</th><th scope=col>n_flowers</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>6.3</td><td>3.3</td><td>6.0</td><td>2.5</td><td>virginica</td><td> 0.45666667</td><td>1.2700404</td><td>150</td></tr>
	<tr><th scope=row>2</th><td>5.8</td><td>2.7</td><td>5.1</td><td>1.9</td><td>virginica</td><td>-0.04333333</td><td>0.7602115</td><td>150</td></tr>
	<tr><th scope=row>3</th><td>7.1</td><td>3.0</td><td>5.9</td><td>2.1</td><td>virginica</td><td> 1.25666667</td><td>1.2133927</td><td>150</td></tr>
	<tr><th scope=row>4</th><td>6.3</td><td>2.9</td><td>5.6</td><td>1.8</td><td>virginica</td><td> 0.45666667</td><td>1.0434497</td><td>150</td></tr>
	<tr><th scope=row>5</th><td>6.5</td><td>3.0</td><td>5.8</td><td>2.2</td><td>virginica</td><td> 0.65666667</td><td>1.1567451</td><td>150</td></tr>
	<tr><th scope=row>6</th><td>7.6</td><td>3.0</td><td>6.6</td><td>2.1</td><td>virginica</td><td> 1.75666667</td><td>1.6099263</td><td>150</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Here’s where the pipe becomes useful. Let’s say you want to calculate the summarise we described above separately for the versicolor and virginica species. I will show you later how to do it more efficiently, but for the moment we can illustrate how you can chain commands with pipes. Rather than creating the intermediate <code class="docutils literal notranslate"><span class="pre">versi.dat</span></code> and <code class="docutils literal notranslate"><span class="pre">virgi.dat</span></code> dataframes, we can chain the <code class="docutils literal notranslate"><span class="pre">summarise</span></code> function after the <code class="docutils literal notranslate"><span class="pre">filter</span></code> function. In the example below, we pass <code class="docutils literal notranslate"><span class="pre">dat</span></code> as the first argument of <code class="docutils literal notranslate"><span class="pre">filter</span></code>, then specify to keep only versicolor flowers, and then the resulting data.frame is passed on as the first argument to summarise:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate summarise for versicolor species</span>
<span class="n">dat</span>  <span class="o">%&gt;%</span> 
 <span class="nf">filter</span><span class="p">(</span><span class="n">Species</span> <span class="o">==</span> <span class="s">&#39;versicolor&#39;</span><span class="p">)</span>  <span class="o">%&gt;%</span> 
 <span class="nf">summarise</span><span class="p">(</span><span class="n">SepLen_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">),</span>
           <span class="n">SepLen_sd</span> <span class="o">=</span> <span class="nf">sd</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">))</span>

<span class="c1"># calculate summarise for virginica species</span>
<span class="n">dat</span>  <span class="o">%&gt;%</span> 
 <span class="nf">filter</span><span class="p">(</span><span class="n">Species</span> <span class="o">==</span> <span class="s">&#39;virginica&#39;</span><span class="p">)</span>  <span class="o">%&gt;%</span> 
 <span class="nf">summarise</span><span class="p">(</span><span class="n">SepLen_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">),</span>
           <span class="n">SepLen_sd</span> <span class="o">=</span> <span class="nf">sd</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 1 × 2</caption>
<thead>
	<tr><th scope=col>SepLen_mean</th><th scope=col>SepLen_sd</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>5.936</td><td>0.5161711</td></tr>
</tbody>
</table>
</div><div class="output text_html"><table>
<caption>A data.frame: 1 × 2</caption>
<thead>
	<tr><th scope=col>SepLen_mean</th><th scope=col>SepLen_sd</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>6.588</td><td>0.6358796</td></tr>
</tbody>
</table>
</div></div>
</div>
<p><strong><em>TIP</em></strong>: it is very easy to remove missing values by using the !<a class="reference external" href="http://is.na">is.na</a>(variable) command. E.g. if some flowers are missing petal length measurements, you can exclude them by doing <strong><code class="docutils literal notranslate"><span class="pre">filter(dat,</span> <span class="pre">!is.na(Petal.Length))</span></code></strong></p>
</div>
<div class="section" id="removing-selecting-columns-to-keep-select">
<h2>Removing/selecting columns to keep - select()<a class="headerlink" href="#removing-selecting-columns-to-keep-select" title="Permalink to this headline">¶</a></h2>
<p>Often the dataset contains many irrelevant columns that make it difficult to display the dataframe all at once. You can easily choose which columns to keep or remove in a data.frame with the <strong><code class="docutils literal notranslate"><span class="pre">select()</span></code></strong> command. It has complex usage, and I suggest checking the help, i.e. type <code class="docutils literal notranslate"><span class="pre">?select</span></code>. However, the basic usage is as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">select</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">Species</span><span class="p">,</span> <span class="n">Petal.Length</span><span class="p">,</span> <span class="n">Petal.Width</span><span class="p">)</span>  <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">()</span> 
<span class="c1">#to keep only specific variables, list them one after another like above</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 3</caption>
<thead>
	<tr><th></th><th scope=col>Species</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th></tr>
	<tr><th></th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>setosa</td><td>1.4</td><td>0.2</td></tr>
	<tr><th scope=row>2</th><td>setosa</td><td>1.4</td><td>0.2</td></tr>
	<tr><th scope=row>3</th><td>setosa</td><td>1.3</td><td>0.2</td></tr>
	<tr><th scope=row>4</th><td>setosa</td><td>1.5</td><td>0.2</td></tr>
	<tr><th scope=row>5</th><td>setosa</td><td>1.4</td><td>0.2</td></tr>
	<tr><th scope=row>6</th><td>setosa</td><td>1.7</td><td>0.4</td></tr>
</tbody>
</table>
</div></div>
</div>
<ul class="simple">
<li><p>If you want to <strong>remove</strong> only specific variables, list each with a <strong>-</strong> sign:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">select</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="o">-</span><span class="n">Sepal.Length</span><span class="p">,</span> <span class="o">-</span><span class="n">Sepal.Width</span><span class="p">)</span>  <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">()</span> <span class="c1">#remove original sepal length &amp; width variables</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 6</caption>
<thead>
	<tr><th></th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th><th scope=col>centered_SepLen</th><th scope=col>PetLen_zscores</th><th scope=col>n_flowers</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.7433333</td><td>-1.335752</td><td>150</td></tr>
	<tr><th scope=row>2</th><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.9433333</td><td>-1.335752</td><td>150</td></tr>
	<tr><th scope=row>3</th><td>1.3</td><td>0.2</td><td>setosa</td><td>-1.1433333</td><td>-1.392399</td><td>150</td></tr>
	<tr><th scope=row>4</th><td>1.5</td><td>0.2</td><td>setosa</td><td>-1.2433333</td><td>-1.279104</td><td>150</td></tr>
	<tr><th scope=row>5</th><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.8433333</td><td>-1.335752</td><td>150</td></tr>
	<tr><th scope=row>6</th><td>1.7</td><td>0.4</td><td>setosa</td><td>-0.4433333</td><td>-1.165809</td><td>150</td></tr>
</tbody>
</table>
</div></div>
</div>
<ul class="simple">
<li><p>If you want to keep a sequence of variables, you can specify the first and the last using a range:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># look at full data set</span>
<span class="nf">head</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
<span class="c1"># look at just a certain range of variables</span>
<span class="nf">select</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">Sepal.Length</span><span class="o">:</span><span class="n">Species</span><span class="p">)</span>  <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">()</span>  <span class="c1">#note: this is an inclusive range (first and last variables included)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 8</caption>
<thead>
	<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th><th scope=col>centered_SepLen</th><th scope=col>PetLen_zscores</th><th scope=col>n_flowers</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.7433333</td><td>-1.335752</td><td>150</td></tr>
	<tr><th scope=row>2</th><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.9433333</td><td>-1.335752</td><td>150</td></tr>
	<tr><th scope=row>3</th><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa</td><td>-1.1433333</td><td>-1.392399</td><td>150</td></tr>
	<tr><th scope=row>4</th><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>setosa</td><td>-1.2433333</td><td>-1.279104</td><td>150</td></tr>
	<tr><th scope=row>5</th><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.8433333</td><td>-1.335752</td><td>150</td></tr>
	<tr><th scope=row>6</th><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa</td><td>-0.4433333</td><td>-1.165809</td><td>150</td></tr>
</tbody>
</table>
</div><div class="output text_html"><table>
<caption>A data.frame: 6 × 5</caption>
<thead>
	<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>2</th><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>3</th><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>4</th><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>5</th><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>setosa</td></tr>
	<tr><th scope=row>6</th><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa</td></tr>
</tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="sorting-the-data-frame-by-columns-arrange">
<h2>Sorting the data.frame by columns - arrange()<a class="headerlink" href="#sorting-the-data-frame-by-columns-arrange" title="Permalink to this headline">¶</a></h2>
<p>If you want to sort your data.frame by one or more columns you can use the <code class="docutils literal notranslate"><span class="pre">arrange()</span></code> command, where you list the variables in the order in which you want the sorting to occur. The default is to sort by ascending order for each variable. If you want to sort by descending order for one of them, you can surround the variable in the <code class="docutils literal notranslate"><span class="pre">desc()</span></code> command. Let’s sort the flowers by species, and then within each species, by descending petal length:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">arrange</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">Species</span><span class="p">,</span> <span class="nf">desc</span><span class="p">(</span><span class="n">Petal.Length</span><span class="p">))</span>  <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">()</span>

<span class="c1"># arrange(dat, desc(Species), desc(Petal.Length)) %&gt;% head()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 8</caption>
<thead>
	<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th><th scope=col>centered_SepLen</th><th scope=col>PetLen_zscores</th><th scope=col>n_flowers</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>4.8</td><td>3.4</td><td>1.9</td><td>0.2</td><td>setosa</td><td>-1.0433333</td><td>-1.052513</td><td>150</td></tr>
	<tr><th scope=row>2</th><td>5.1</td><td>3.8</td><td>1.9</td><td>0.4</td><td>setosa</td><td>-0.7433333</td><td>-1.052513</td><td>150</td></tr>
	<tr><th scope=row>3</th><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa</td><td>-0.4433333</td><td>-1.165809</td><td>150</td></tr>
	<tr><th scope=row>4</th><td>5.7</td><td>3.8</td><td>1.7</td><td>0.3</td><td>setosa</td><td>-0.1433333</td><td>-1.165809</td><td>150</td></tr>
	<tr><th scope=row>5</th><td>5.4</td><td>3.4</td><td>1.7</td><td>0.2</td><td>setosa</td><td>-0.4433333</td><td>-1.165809</td><td>150</td></tr>
	<tr><th scope=row>6</th><td>5.1</td><td>3.3</td><td>1.7</td><td>0.5</td><td>setosa</td><td>-0.7433333</td><td>-1.165809</td><td>150</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Note: since the <code class="docutils literal notranslate"><span class="pre">Species</span></code> variable is a factor, not a numeric variable, it will be sorted by the order listed by <code class="docutils literal notranslate"><span class="pre">levels(dat$Species)</span></code>. You can test this out by uncommenting the second line in the code cell above - since the flowers are now sorted in the reverse <code class="docutils literal notranslate"><span class="pre">Species</span></code> order, the first six rows shown by <code class="docutils literal notranslate"><span class="pre">head()</span></code> are now virginica, not setosa.</p>
</div>
<div class="section" id="combine-concatenate-values-from-two-columns-into-one-unite">
<h2>Combine/concatenate values from two columns into one - unite()<a class="headerlink" href="#combine-concatenate-values-from-two-columns-into-one-unite" title="Permalink to this headline">¶</a></h2>
<p>Let’s say flowers with short petals are fundamentally different from those with long petals. I’m going to make a new categorical variable, <code class="docutils literal notranslate"><span class="pre">PetalType</span></code>, that can either be “long” or “short”. <em>To learn more about the <code class="docutils literal notranslate"><span class="pre">ifelse()</span></code> function used below, type <code class="docutils literal notranslate"><span class="pre">?ifelse</span></code>.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span> <span class="o">&lt;-</span> <span class="n">dat</span>  <span class="o">%&gt;%</span>  
    <span class="nf">mutate</span><span class="p">(</span><span class="n">PetalType</span> <span class="o">=</span> <span class="nf">ifelse</span><span class="p">(</span><span class="n">Petal.Length</span> <span class="o">&gt;</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Petal.Length</span><span class="p">),</span><span class="s">&quot;long&quot;</span><span class="p">,</span><span class="s">&quot;short&quot;</span><span class="p">))</span>

<span class="nf">barplot</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">PetalType</span><span class="p">),</span><span class="n">main</span><span class="o">=</span><span class="s">&quot;Number of flowers for each PetalType&quot;</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 9</caption>
<thead>
	<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species</th><th scope=col>centered_SepLen</th><th scope=col>PetLen_zscores</th><th scope=col>n_flowers</th><th scope=col>PetalType</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.7433333</td><td>-1.335752</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>2</th><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.9433333</td><td>-1.335752</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>3</th><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa</td><td>-1.1433333</td><td>-1.392399</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>4</th><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>setosa</td><td>-1.2433333</td><td>-1.279104</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>5</th><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>setosa</td><td>-0.8433333</td><td>-1.335752</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>6</th><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa</td><td>-0.4433333</td><td>-1.165809</td><td>150</td><td>short</td></tr>
</tbody>
</table>
</div><img alt="../_images/data-as-objects-and-architectures_80_1.png" src="../_images/data-as-objects-and-architectures_80_1.png" />
</div>
</div>
<p>Right now <code class="docutils literal notranslate"><span class="pre">Species</span></code> and <code class="docutils literal notranslate"><span class="pre">PetalType</span></code> are two different variables. Let’s say for some reason you want a new variable that specifies both, e.g. ‘short virginica’, ‘long setosa’, etc. This is often useful when you are plotting and you want to use a color to denote each combination of two variables, instead of using a combination of colors and shapes. You can combine variables with the <code class="docutils literal notranslate"><span class="pre">unite()</span></code> command.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span> <span class="o">&lt;-</span> <span class="n">dat</span> <span class="o">%&gt;%</span> 
      <span class="nf">unite</span><span class="p">(</span><span class="n">Combined_var</span><span class="p">,</span> <span class="n">Species</span><span class="p">,</span> <span class="n">PetalType</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 10</caption>
<thead>
	<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Combined_var</th><th scope=col>Species</th><th scope=col>centered_SepLen</th><th scope=col>PetLen_zscores</th><th scope=col>n_flowers</th><th scope=col>PetalType</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>setosa_short</td><td>setosa</td><td>-0.7433333</td><td>-1.335752</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>2</th><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>setosa_short</td><td>setosa</td><td>-0.9433333</td><td>-1.335752</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>3</th><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa_short</td><td>setosa</td><td>-1.1433333</td><td>-1.392399</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>4</th><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>setosa_short</td><td>setosa</td><td>-1.2433333</td><td>-1.279104</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>5</th><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>setosa_short</td><td>setosa</td><td>-0.8433333</td><td>-1.335752</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>6</th><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa_short</td><td>setosa</td><td>-0.4433333</td><td>-1.165809</td><td>150</td><td>short</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">mutate()</span></code>, you can also specify the separator (by default it is ‘_’) and whether to remove the original variables. Check the help section for more on how to do this (<code class="docutils literal notranslate"><span class="pre">?unite</span></code>). Note that in the commented section of the cell above, I generated the new variable and the combined variable all at once.</p>
</div>
<div class="section" id="split-variable-into-multiple-variables-separate">
<h2>Split variable into multiple variables - separate()<a class="headerlink" href="#split-variable-into-multiple-variables-separate" title="Permalink to this headline">¶</a></h2>
<p>The reverse of the operation above is called <code class="docutils literal notranslate"><span class="pre">separate()</span></code>. It becomes useful, for example, if you have the name of participants stored in one variable, but you want to separate it into First and Last name. For the illustration, I will just reverse the above example (adding 1 to the new variables, to distinguish them from the existing Species and PetalType variables):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span> <span class="o">&lt;-</span> <span class="n">dat</span>  <span class="o">%&gt;%</span> 
    <span class="nf">separate</span><span class="p">(</span><span class="n">Combined_var</span><span class="p">,</span> <span class="n">into</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;Species1&#39;</span><span class="p">,</span> <span class="s">&#39;PetalType1&#39;</span><span class="p">))</span> <span class="c1">#separate combined variable into the two original variables </span>
<span class="nf">head</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 11</caption>
<thead>
	<tr><th></th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species1</th><th scope=col>PetalType1</th><th scope=col>Species</th><th scope=col>centered_SepLen</th><th scope=col>PetLen_zscores</th><th scope=col>n_flowers</th><th scope=col>PetalType</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>setosa</td><td>short</td><td>setosa</td><td>-0.7433333</td><td>-1.335752</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>2</th><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>setosa</td><td>short</td><td>setosa</td><td>-0.9433333</td><td>-1.335752</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>3</th><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa</td><td>short</td><td>setosa</td><td>-1.1433333</td><td>-1.392399</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>4</th><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>setosa</td><td>short</td><td>setosa</td><td>-1.2433333</td><td>-1.279104</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>5</th><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>setosa</td><td>short</td><td>setosa</td><td>-0.8433333</td><td>-1.335752</td><td>150</td><td>short</td></tr>
	<tr><th scope=row>6</th><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa</td><td>short</td><td>setosa</td><td>-0.4433333</td><td>-1.165809</td><td>150</td><td>short</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Like with <code class="docutils literal notranslate"><span class="pre">unite()</span></code>, you can specify the character you want <code class="docutils literal notranslate"><span class="pre">separate()</span></code> to split. For example, splitting at ” ” instead of at the default “_” for the First, Last name example. See <code class="docutils literal notranslate"><span class="pre">?separate</span></code> for more info.</p>
</div>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="performing-the-same-operation-for-multiple-groups-and-combining-the-results">
<h1>Performing the same operation for multiple groups and combining the results<a class="headerlink" href="#performing-the-same-operation-for-multiple-groups-and-combining-the-results" title="Permalink to this headline">¶</a></h1>
<p>In the filtering example in section 4.3, we saw how to subset the data.frame separately for different species, and then to calculate the summaries. This is inefficient and also creates two separate data.frames. While you can join them manually afterwards, there is a much easier way with the <strong><code class="docutils literal notranslate"><span class="pre">group_by</span></code></strong> command.</p>
<p>When you pass a data.frame to a <strong>group_by</strong> command, you can specify names of variables, by which to split the data.frame. For example, if we specify the <code class="docutils literal notranslate"><span class="pre">Species</span></code> and <code class="docutils literal notranslate"><span class="pre">PetalType</span></code> variables in the group_by command, the data.frame will be <strong><em>implicitly</em></strong> split into 4 data.frames - one for each combination of species and petal type (note that there are only 2 species for <code class="docutils literal notranslate"><span class="pre">cleaned_dat</span></code> now because we got rid of the “setosa” species in section 4.3). E.g.:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cleaned_dat</span> <span class="o">&lt;-</span> <span class="n">cleaned_dat</span>  <span class="o">%&gt;%</span>  
    <span class="nf">mutate</span><span class="p">(</span><span class="n">PetalType</span> <span class="o">=</span> <span class="nf">ifelse</span><span class="p">(</span><span class="n">Petal.Length</span> <span class="o">&gt;</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Petal.Length</span><span class="p">),</span><span class="s">&quot;long&quot;</span><span class="p">,</span><span class="s">&quot;short&quot;</span><span class="p">))</span> <span class="c1"># this creates the PetalType variable for cleaned_dat</span>

<span class="n">cleaned_dat</span> <span class="o">%&gt;%</span> 
    <span class="nf">group_by</span><span class="p">(</span><span class="n">Species</span><span class="p">,</span> <span class="n">PetalType</span><span class="p">)</span>  <span class="o">%&gt;%</span> <span class="c1"># group them by the</span>
    <span class="nf">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># A tibble: 100 x 9
# Groups:   Species, PetalType [4]
   Sepal.Length Sepal.Width Petal.Length Petal.Width Species centered_SepLen
          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;             &lt;dbl&gt;
 1          7           3.2          4.7         1.4 versic…           1.16 
 2          6.4         3.2          4.5         1.5 versic…           0.557
 3          6.9         3.1          4.9         1.5 versic…           1.06 
 4          5.5         2.3          4           1.3 versic…          -<span class=" -Color -Color-Red">0.343</span>
 5          6.5         2.8          4.6         1.5 versic…           0.657
 6          5.7         2.8          4.5         1.3 versic…          -<span class=" -Color -Color-Red">0.143</span>
 7          6.3         3.3          4.7         1.6 versic…           0.457
 8          4.9         2.4          3.3         1   versic…          -<span class=" -Color -Color-Red">0.943</span>
 9          6.6         2.9          4.6         1.3 versic…           0.757
10          5.2         2.7          3.9         1.4 versic…          -<span class=" -Color -Color-Red">0.643</span>
# … with 90 more rows, and 3 more variables: PetLen_zscores &lt;dbl&gt;,
#   n_flowers &lt;int&gt;, PetalType &lt;chr&gt;
</pre></div>
</div>
</div>
</div>
<p>Now, the key is that the split is implicit - as you can see above, we still only have one data.frame, but now it has the specification:</p>
<p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">Groups:</span>&#160;&#160; <span class="pre">Species,</span> <span class="pre">PetalType</span> <span class="pre">[4]</span></code></p>
<p>Every function that you add after <code class="docutils literal notranslate"><span class="pre">group_by()</span></code>, will be evaluated separately for each group, and then the results will be combined. Let’s say you want to calculate the mean and sd for <code class="docutils literal notranslate"><span class="pre">Sepal.Length</span></code> and <code class="docutils literal notranslate"><span class="pre">Sepal.Width</span></code> separately for the four groups:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cleaned_dat</span>  <span class="o">%&gt;%</span> 
    <span class="nf">group_by</span><span class="p">(</span><span class="n">Species</span><span class="p">,</span> <span class="n">PetalType</span><span class="p">)</span>  <span class="o">%&gt;%</span> 
    <span class="nf">summarise</span><span class="p">(</span><span class="n">SepLen_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">),</span>
              <span class="n">SepLen_sd</span> <span class="o">=</span> <span class="nf">sd</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">),</span>
              <span class="n">SepWid_mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Sepal.Width</span><span class="p">),</span>
              <span class="n">SepWid_sd</span> <span class="o">=</span> <span class="nf">sd</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`summarise()` regrouping output by &#39;Species&#39; (override with `.groups` argument)
</pre></div>
</div>
<div class="output text_html"><table>
<caption>A grouped_df: 4 × 6</caption>
<thead>
	<tr><th scope=col>Species</th><th scope=col>PetalType</th><th scope=col>SepLen_mean</th><th scope=col>SepLen_sd</th><th scope=col>SepWid_mean</th><th scope=col>SepWid_sd</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>versicolor</td><td>long </td><td>6.350000</td><td>0.4949747</td><td>2.850000</td><td>0.4949747</td></tr>
	<tr><td>versicolor</td><td>short</td><td>5.918750</td><td>0.5147428</td><td>2.766667</td><td>0.5147428</td></tr>
	<tr><td>virginica </td><td>long </td><td>6.688636</td><td>0.5851718</td><td>2.997727</td><td>0.5851718</td></tr>
	<tr><td>virginica </td><td>short</td><td>5.850000</td><td>0.5244044</td><td>2.800000</td><td>0.5244044</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>And that’s all the code you need. If you have tried to do something like this in base R (i.e., without <code class="docutils literal notranslate"><span class="pre">dplyr</span></code> commands), you know how involved it is! <code class="docutils literal notranslate"><span class="pre">dplyr</span></code> can make your code <strong>much</strong> cleaner. What is going on behind the scenes is that the data.frame is separated into multiple data.frames, one for each combination of variables. Then the <code class="docutils literal notranslate"><span class="pre">summarise</span></code> function is executed on each, and the resulting 4 data.frames are automatically combined into a new resulting data.frame.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">group_by</span></code> command works not only with <code class="docutils literal notranslate"><span class="pre">summarise</span></code>, but also with <code class="docutils literal notranslate"><span class="pre">mutate</span></code>. While with <code class="docutils literal notranslate"><span class="pre">summarise</span></code> it creates a new data.frame with summary results, with <code class="docutils literal notranslate"><span class="pre">mutate</span></code> it creates a new variable that is calculated separately for each group, and then combined into the final data.frame. This is useful, when, for example, we want to standardize variables within groups. Earlier we saw how to remove the overall mean of <code class="docutils literal notranslate"><span class="pre">Sepal.Length</span></code>. Let’s say that we want to remove the mean <code class="docutils literal notranslate"><span class="pre">Sepal.Length</span></code> of each species from only from the flowers in that species. So, for our example we can do:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span>  <span class="o">%&gt;%</span> 
 <span class="nf">mutate</span><span class="p">(</span><span class="n">SepLen_centered_overall</span> <span class="o">=</span> <span class="n">Sepal.Length</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">))</span>  <span class="o">%&gt;%</span> <span class="c1">#center values by mean for all data</span>
 <span class="nf">group_by</span><span class="p">(</span><span class="n">Species</span><span class="p">)</span>  <span class="o">%&gt;%</span> 
 <span class="nf">mutate</span><span class="p">(</span><span class="n">SepLen_centered_byspecies</span> <span class="o">=</span> <span class="n">Sepal.Length</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">))</span>  <span class="o">%&gt;%</span> <span class="c1">#center values by mean for each species</span>
 <span class="c1"># select(SepLen_centered_overall:SepLen_centered_byspecies) %&gt;% # just show the relevant variables (there are a lot of variables in this data.frame now!)</span>
 <span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A grouped_df: 6 × 13</caption>
<thead>
	<tr><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Species1</th><th scope=col>PetalType1</th><th scope=col>Species</th><th scope=col>centered_SepLen</th><th scope=col>PetLen_zscores</th><th scope=col>n_flowers</th><th scope=col>PetalType</th><th scope=col>SepLen_centered_overall</th><th scope=col>SepLen_centered_byspecies</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>setosa</td><td>short</td><td>setosa</td><td>-0.7433333</td><td>-1.335752</td><td>150</td><td>short</td><td>-0.7433333</td><td> 0.094</td></tr>
	<tr><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>setosa</td><td>short</td><td>setosa</td><td>-0.9433333</td><td>-1.335752</td><td>150</td><td>short</td><td>-0.9433333</td><td>-0.106</td></tr>
	<tr><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>setosa</td><td>short</td><td>setosa</td><td>-1.1433333</td><td>-1.392399</td><td>150</td><td>short</td><td>-1.1433333</td><td>-0.306</td></tr>
	<tr><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>setosa</td><td>short</td><td>setosa</td><td>-1.2433333</td><td>-1.279104</td><td>150</td><td>short</td><td>-1.2433333</td><td>-0.406</td></tr>
	<tr><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>setosa</td><td>short</td><td>setosa</td><td>-0.8433333</td><td>-1.335752</td><td>150</td><td>short</td><td>-0.8433333</td><td>-0.006</td></tr>
	<tr><td>5.4</td><td>3.9</td><td>1.7</td><td>0.4</td><td>setosa</td><td>short</td><td>setosa</td><td>-0.4433333</td><td>-1.165809</td><td>150</td><td>short</td><td>-0.4433333</td><td> 0.394</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>The second line above gives us the sepal lengths centered over the whole sample, while the 4th line, even though it looks the same, gives us the sepal lengths centered separately for each species. To illustrate, I will plot the means for each species under the two centerings (don’t worry about the code if you don’t know <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> yet):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">dat</span>  <span class="o">%&gt;%</span> 
 <span class="nf">mutate</span><span class="p">(</span><span class="n">SepLen_centered_overall</span> <span class="o">=</span> <span class="n">Sepal.Length</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">))</span>  <span class="o">%&gt;%</span> <span class="c1">#center values by mean for all data</span>
 <span class="nf">group_by</span><span class="p">(</span><span class="n">Species</span><span class="p">)</span>  <span class="o">%&gt;%</span> 
 <span class="nf">mutate</span><span class="p">(</span><span class="n">SepLen_centered_byspecies</span> <span class="o">=</span> <span class="n">Sepal.Length</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="p">))</span>  <span class="o">%&gt;%</span> 
 <span class="nf">gather</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="n">centering_type</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">SepLen_centered</span><span class="p">,</span> <span class="n">SepLen_centered_overall</span><span class="p">,</span> <span class="n">SepLen_centered_byspecies</span><span class="p">)</span>  <span class="o">%&gt;%</span> 
 <span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">Species</span><span class="p">,</span> <span class="n">SepLen_centered</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">centering_type</span><span class="p">))</span> <span class="o">+</span>
    <span class="nf">stat_summary</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&#39;point&#39;</span><span class="p">,</span><span class="n">fun</span><span class="o">=</span><span class="n">mean</span><span class="p">)</span> <span class="o">+</span>
    <span class="nf">theme_classic</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/data-as-objects-and-architectures_96_0.png" src="../_images/data-as-objects-and-architectures_96_0.png" />
</div>
</div>
<p>This plot makes sense, because if you’re calculating <code class="docutils literal notranslate"><span class="pre">SepLen_centering_byspecies</span></code> by subtracting the species mean from each <code class="docutils literal notranslate"><span class="pre">Sepal.Length</span></code> value, the mean of the new values should be 0 for every species. Meanwhile, the <code class="docutils literal notranslate"><span class="pre">SepLen_centering_overall</span></code> values were calculated by subtracting the same amount from all <code class="docutils literal notranslate"><span class="pre">Sepal.Length</span></code> values, regardless of species, so we still see variation for these means across species.</p>
<p>There are a lot of other handy uses for <code class="docutils literal notranslate"><span class="pre">group_by</span></code>, which will be covered in future tutorials.</p>
</div>
<hr class="docutils" />
<div class="tex2jax_ignore mathjax_ignore section" id="restructuring-data-frames-long-to-wide-wide-to-long-and-merging-data-frames">
<h1>Restructuring data.frames - long to wide, wide to long, and merging data.frames<a class="headerlink" href="#restructuring-data-frames-long-to-wide-wide-to-long-and-merging-data-frames" title="Permalink to this headline">¶</a></h1>
<p>Remember how in section 2 we talked about how it’s better to have a single observation in each row, instead of multiple observations per row? In this section we’ll use the <code class="docutils literal notranslate"><span class="pre">dplyr</span></code> functions <code class="docutils literal notranslate"><span class="pre">gather</span></code> and <code class="docutils literal notranslate"><span class="pre">spread</span></code> to switch between short and long forms of the data. We’ll also try out combining data.frames using <code class="docutils literal notranslate"><span class="pre">join</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">iris</span></code> data set has multiple measurements per row, so it is currently in the “wide” format. To put it in long format, we can make each row only have one measurement, and then variables that specify whether that measurment is for “sepal” or “petal”, “length” or “width”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">newdat</span> <span class="o">&lt;-</span> <span class="n">iris</span> <span class="c1"># new duplicate of iris dataset so we don&#39;t have to deal with all the messy variables we created</span>
<span class="n">newdat</span><span class="o">$</span><span class="n">flower.num</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">newdat</span><span class="p">)</span> <span class="c1"># like a participant ID, so we can put these back where they came from using &quot;spread&quot;</span>
<span class="n">newdat</span> <span class="o">&lt;-</span> <span class="n">newdat</span> <span class="o">%&gt;%</span>
      <span class="nf">gather</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s">&quot;flower_att&quot;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s">&quot;measurement&quot;</span><span class="p">,</span>
      <span class="n">Sepal.Length</span><span class="p">,</span> <span class="n">Sepal.Width</span><span class="p">,</span> <span class="n">Petal.Length</span><span class="p">,</span> <span class="n">Petal.Width</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">newdat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 4</caption>
<thead>
	<tr><th></th><th scope=col>Species</th><th scope=col>flower.num</th><th scope=col>flower_att</th><th scope=col>measurement</th></tr>
	<tr><th></th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>setosa</td><td>1</td><td>Sepal.Length</td><td>5.1</td></tr>
	<tr><th scope=row>2</th><td>setosa</td><td>2</td><td>Sepal.Length</td><td>4.9</td></tr>
	<tr><th scope=row>3</th><td>setosa</td><td>3</td><td>Sepal.Length</td><td>4.7</td></tr>
	<tr><th scope=row>4</th><td>setosa</td><td>4</td><td>Sepal.Length</td><td>4.6</td></tr>
	<tr><th scope=row>5</th><td>setosa</td><td>5</td><td>Sepal.Length</td><td>5.0</td></tr>
	<tr><th scope=row>6</th><td>setosa</td><td>6</td><td>Sepal.Length</td><td>5.4</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Now this data set is in a long format, which is a tidier format for answering analysis questions (“Are petals longer than they are wide?”) and for visualization. If I wanted to, I could use <code class="docutils literal notranslate"><span class="pre">separate()</span></code> to make the <code class="docutils literal notranslate"><span class="pre">flower_att</span></code> variable into two variables. We can also easily put it back in “wide” format using <code class="docutils literal notranslate"><span class="pre">spread</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">newdat</span> <span class="o">&lt;-</span> <span class="n">newdat</span> <span class="o">%&gt;%</span>
      <span class="nf">spread</span><span class="p">(</span><span class="n">flower_att</span><span class="p">,</span><span class="n">measurement</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">newdat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 6 × 6</caption>
<thead>
	<tr><th></th><th scope=col>Species</th><th scope=col>flower.num</th><th scope=col>Petal.Length</th><th scope=col>Petal.Width</th><th scope=col>Sepal.Length</th><th scope=col>Sepal.Width</th></tr>
	<tr><th></th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>setosa</td><td>1</td><td>1.4</td><td>0.2</td><td>5.1</td><td>3.5</td></tr>
	<tr><th scope=row>2</th><td>setosa</td><td>2</td><td>1.4</td><td>0.2</td><td>4.9</td><td>3.0</td></tr>
	<tr><th scope=row>3</th><td>setosa</td><td>3</td><td>1.3</td><td>0.2</td><td>4.7</td><td>3.2</td></tr>
	<tr><th scope=row>4</th><td>setosa</td><td>4</td><td>1.5</td><td>0.2</td><td>4.6</td><td>3.1</td></tr>
	<tr><th scope=row>5</th><td>setosa</td><td>5</td><td>1.4</td><td>0.2</td><td>5.0</td><td>3.6</td></tr>
	<tr><th scope=row>6</th><td>setosa</td><td>6</td><td>1.7</td><td>0.4</td><td>5.4</td><td>3.9</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>The last function we’ll cover in this tutorial is the <code class="docutils literal notranslate"><span class="pre">left_join()</span></code> function. Imagine that you saved your data so that personal information such as age was saved separately from your participants’ response data. However, now you want to see if age impacts your effect size, and you’d like to add age as a variable in your main dataset. As long as both your response dataset and your personal information dataset have the participant ID in them, you should be able to add the participants’ ages to the dataset easily using <code class="docutils literal notranslate"><span class="pre">left_join()</span></code>. See <a class="reference external" href="https://dplyr.tidyverse.org/reference/join.html">this page</a> for more versions of the <code class="docutils literal notranslate"><span class="pre">join()</span></code> function that you can use to make merging datasets easier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">personal</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;p01&quot;</span><span class="p">,</span><span class="s">&quot;p02&quot;</span><span class="p">),</span> <span class="n">age</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">18</span><span class="p">,</span><span class="m">21</span><span class="p">),</span> <span class="n">firstlang</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;English&quot;</span><span class="p">,</span> <span class="s">&quot;Chinese&quot;</span><span class="p">))</span> <span class="c1"># participant info</span>
<span class="n">response</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;p01&quot;</span><span class="p">,</span><span class="s">&quot;p01&quot;</span><span class="p">,</span><span class="s">&quot;p02&quot;</span><span class="p">,</span><span class="s">&quot;p02&quot;</span><span class="p">),</span><span class="n">response</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">))</span> <span class="c1"># response database</span>
<span class="nf">head</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

<span class="n">response</span> <span class="o">&lt;-</span> <span class="n">response</span> <span class="o">%&gt;%</span> <span class="nf">left_join</span><span class="p">(</span><span class="nf">select</span><span class="p">(</span><span class="n">personal</span><span class="p">,</span><span class="n">name</span><span class="o">:</span><span class="n">age</span><span class="p">))</span> <span class="c1"># don&#39;t need to use &quot;select&quot;, but it avoids adding info not needed </span>
<span class="nf">head</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<caption>A data.frame: 4 × 2</caption>
<thead>
	<tr><th></th><th scope=col>name</th><th scope=col>response</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>p01</td><td>0</td></tr>
	<tr><th scope=row>2</th><td>p01</td><td>1</td></tr>
	<tr><th scope=row>3</th><td>p02</td><td>1</td></tr>
	<tr><th scope=row>4</th><td>p02</td><td>0</td></tr>
</tbody>
</table>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Joining, by = &quot;name&quot;
</pre></div>
</div>
<div class="output text_html"><table>
<caption>A data.frame: 4 × 3</caption>
<thead>
	<tr><th></th><th scope=col>name</th><th scope=col>response</th><th scope=col>age</th></tr>
	<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>p01</td><td>0</td><td>18</td></tr>
	<tr><th scope=row>2</th><td>p01</td><td>1</td><td>18</td></tr>
	<tr><th scope=row>3</th><td>p02</td><td>1</td><td>21</td></tr>
	<tr><th scope=row>4</th><td>p02</td><td>0</td><td>21</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>That’s all the tidyverse functions we’ll cover for now!</p>
<p><em>Notebook authored by Ven Popov and edited by Krista Bond, Charles Wu, Patience Stevens, and Amy Sentis.</em></p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../lectures/data-as-objects-and-architectures.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Data as objects and architectures</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../discussions/data-as-objects-and-architectures.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Discussion questions:</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Timothy Verstynen, Venn Popov, Krista Bond, Charles Wu, Patience Stevens, Amy Sentis<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>